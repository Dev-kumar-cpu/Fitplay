<!DOCTYPE html>
<!--
  ============================================================================
  FitPlay Web App - Dashboard Page (User Home After Login)
  ============================================================================
  
  Project: FitPlay - Gamified Fitness Tracking Web Application
  This is the main dashboard page shown after user login.
  
  Features:
  - User stats display (points, level, streak, workouts)
  - Today's progress summary
  - Quick action buttons
  - Recent activities list
  - Daily quests display
  
  Technologies: HTML5, CSS3, Vanilla JavaScript
  
  @author FitPlay Team
  @version 1.0.0
  @date 2026
-->
<html lang="en">
<head>
  <!-- Meta tags -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="FitPlay Dashboard - Your Fitness Progress">
  <title>Dashboard - FitPlay</title>
  
  <!-- Firebase SDK -->
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

    // Your Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDHpyUkBjnOOA3r-5CrMnQartcLSpvnlT0",
      authDomain: "fit-play-5da58.firebaseapp.com",
      projectId: "fit-play-5da58",
      storageBucket: "fit-play-5da58.firebasestorage.app",
      messagingSenderId: "926966574991",
      appId: "1:926966574991:web:414c7517dbab1df42a65fa",
      measurementId: "G-YKR7EHS84F"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Make available globally
    window.firebaseApp = app;
    window.firebaseAuth = auth;
    window.firebaseDb = db;

    // Check if user is logged in
    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        // Not logged in, redirect to login
        window.location.href = 'login.html';
        return;
      }

      // Load user profile data
      try {
        const userDoc = await getDoc(doc(db, 'users', user.uid));
        if (userDoc.exists()) {
          const userData = userDoc.data();
          updateDashboard(userData, user);
        } else {
          // User profile doesn't exist, create default
          updateDashboard({
            displayName: user.displayName || user.email.split('@')[0],
            totalPoints: 0,
            level: 1,
            streak: 0,
            workoutCount: 0,
            totalMinutes: 0
          }, user);
        }
      } catch (error) {
        console.error('Error loading user data:', error);
        updateDashboard({
          displayName: user.displayName || user.email.split('@')[0],
          totalPoints: 0,
          level: 1,
          streak: 0,
          workoutCount: 0,
          totalMinutes: 0
        }, user);
      }
    });

    // Update dashboard with user data
    function updateDashboard(userData, authUser) {
      // Update user name in navbar
      const userNameElements = document.querySelectorAll('.user-name');
      userNameElements.forEach(el => el.textContent = userData.displayName || 'User');
      
      // Update avatar first letter
      const avatarElements = document.querySelectorAll('.user-avatar');
      const firstLetter = (userData.displayName || 'U')[0].toUpperCase();
      avatarElements.forEach(el => el.textContent = firstLetter);

      // Update welcome section
      const welcomeEl = document.querySelector('.welcome-section h1');
      if (welcomeEl) {
        welcomeEl.textContent = `Welcome back, ${userData.displayName || 'User'}! üëã`;
      }

      // Update stats
      const pointsEl = document.querySelector('.stat-card:nth-child(1) .stat-value');
      if (pointsEl) pointsEl.textContent = userData.totalPoints?.toLocaleString() || '0';

      // Update level
      const levelEl = document.querySelector('.stat-card:nth-child(2) .stat-value');
      if (levelEl) levelEl.textContent = `Level ${userData.level || 1}`;

      // Update streak
      const streakEl = document.querySelector('.stat-card:nth-child(3) .stat-value');
      if (streakEl) streakEl.textContent = userData.streak || '0';

      // Update workout count
      const workoutEl = document.querySelector('.stat-card:nth-child(4) .stat-value');
      if (workoutEl) workoutEl.textContent = userData.workoutCount || '0';

      // Calculate level name
      const levelNames = ['Beginner', 'Amateur', 'Athlete', 'Champion', 'Legend'];
      const levelLabelEl = document.querySelector('.stat-card:nth-child(2) .stat-label');
      if (levelLabelEl) levelLabelEl.textContent = levelNames[(userData.level || 1) - 1] || 'Beginner';
    }

    // Logout function
    window.logout = async function() {
      try {
        await signOut(auth);
        window.location.href = 'index.html';
      } catch (error) {
        console.error('Logout error:', error);
      }
    };
  </script>

  <style>
    /* CSS Variables */
    :root {
      --primary: #667eea;
      --primary-dark: #764ba2;
      --secondary: #f093fb;
      --success: #4CAF50;
      --warning: #ff9800;
      --error: #f44336;
      --background: #f5f5f5;
      --surface: #ffffff;
      --text: #333333;
      --text-muted: #666666;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--background);
      color: var(--text);
    }

    /* Navigation */
    .navbar {
      background: var(--surface);
      padding: 15px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .logo {
      font-size: 24px;
      font-weight: bold;
      color: var(--primary);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .nav-links {
      display: flex;
      gap: 20px;
      align-items: center;
    }

    .nav-links a {
      text-decoration: none;
      color: var(--text);
      font-weight: 500;
      transition: color 0.3s;
    }

    .nav-links a:hover {
      color: var(--primary);
    }

    .user-profile {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
    }

    /* Main container */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 30px 20px;
    }

    /* Welcome section */
    .welcome-section {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      border-radius: 20px;
      padding: 30px;
      color: white;
      margin-bottom: 30px;
    }

    .welcome-section h1 {
      font-size: 28px;
      margin-bottom: 10px;
    }

    .welcome-section p {
      opacity: 0.9;
    }

    /* Stats grid */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: var(--surface);
      border-radius: 15px;
      padding: 25px;
      text-align: center;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }

    .stat-icon {
      font-size: 36px;
      margin-bottom: 10px;
    }

    .stat-value {
      font-size: 32px;
      font-weight: bold;
      color: var(--primary);
    }

    .stat-label {
      color: var(--text-muted);
      font-size: 14px;
      margin-top: 5px;
    }

    /* Today's progress */
    .section {
      background: var(--surface);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }

    .section h2 {
      font-size: 20px;
      margin-bottom: 20px;
      color: var(--text);
    }

    .progress-bar {
      background: #e0e0e0;
      border-radius: 10px;
      height: 20px;
      overflow: hidden;
      margin-bottom: 15px;
    }

    .progress-fill {
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      height: 100%;
      border-radius: 10px;
      transition: width 0.5s ease;
    }

    .progress-stats {
      display: flex;
      justify-content: space-between;
      color: var(--text-muted);
      font-size: 14px;
    }

    /* Quick actions */
    .actions-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
    }

    .action-card {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      border-radius: 12px;
      padding: 20px;
      color: white;
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
      display: flex;
      align-items: center;
      gap: 15px;
      text-decoration: none;
    }

    .action-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
    }

    .action-icon {
      font-size: 32px;
    }

    .action-text h3 {
      font-size: 16px;
      margin-bottom: 5px;
    }

    .action-text p {
      font-size: 12px;
      opacity: 0.9;
    }

    /* Recent activities */
    .activity-list {
      list-style: none;
    }

    .activity-item {
      display: flex;
      align-items: center;
      padding: 15px;
      border-bottom: 1px solid #eee;
      transition: background 0.3s;
    }

    .activity-item:hover {
      background: #f9f9f9;
    }

    .activity-icon {
      font-size: 28px;
      margin-right: 15px;
    }

    .activity-info {
      flex: 1;
    }

    .activity-info h4 {
      font-size: 16px;
      margin-bottom: 3px;
    }

    .activity-info p {
      font-size: 13px;
      color: var(--text-muted);
    }

    .activity-points {
      background: #e8f5e9;
      color: var(--success);
      padding: 5px 12px;
      border-radius: 20px;
      font-weight: bold;
      font-size: 14px;
    }

    /* Daily quests */
    .quest-item {
      display: flex;
      align-items: center;
      padding: 15px;
      border: 1px solid #eee;
      border-radius: 10px;
      margin-bottom: 10px;
    }

    .quest-icon {
      font-size: 28px;
      margin-right: 15px;
    }

    .quest-info {
      flex: 1;
    }

    .quest-info h4 {
      font-size: 15px;
      margin-bottom: 3px;
    }

    .quest-info p {
      font-size: 13px;
      color: var(--text-muted);
    }

    .quest-points {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      padding: 5px 12px;
      border-radius: 20px;
      font-weight: bold;
      font-size: 13px;
    }

    /* Logout button */
    .btn-logout {
      background: var(--error);
      color: white;
      padding: 8px 20px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 500;
    }

    /* Mobile responsive */
    @media (max-width: 768px) {
      .navbar {
        flex-direction: column;
        gap: 15px;
      }
      
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
</head>
<body>
  <!-- Navigation Bar -->
  <nav class="navbar">
    <div class="logo">
      <span>üí™</span>
      <span>FitPlay</span>
    </div>
    <div class="nav-links">
      <a href="dashboard.html">Dashboard</a>
      <a href="activities.html">Activities</a>
      <a href="quests.html">Quests</a>
      <a href="leaderboard.html">Leaderboard</a>
      <div class="user-profile">
        <div class="user-avatar">T</div>
        <span class="user-name">Loading...</span>
        <a href="#" onclick="logout(); return false;" class="btn-logout">Logout</a>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="container">
    <!-- Welcome Section -->
    <section class="welcome-section">
      <h1>Welcome back, Test User! üëã</h1>
      <p>Every step counts! Keep going on your fitness journey.</p>
    </section>

    <!-- Stats Grid -->
    <section class="stats-grid">
      <!-- Points -->
      <div class="stat-card">
        <div class="stat-icon">‚≠ê</div>
        <div class="stat-value">1,250</div>
        <div class="stat-label">Total Points</div>
      </div>

      <!-- Level -->
      <div class="stat-card">
        <div class="stat-icon">üèÜ</div>
        <div class="stat-value">Level 3</div>
        <div class="stat-label">Athlete</div>
      </div>

      <!-- Streak -->
      <div class="stat-card">
        <div class="stat-icon">üî•</div>
        <div class="stat-value">7</div>
        <div class="stat-label">Day Streak</div>
      </div>

      <!-- Workouts -->
      <div class="stat-card">
        <div class="stat-icon">üí™</div>
        <div class="stat-value">23</div>
        <div class="stat-label">Total Workouts</div>
      </div>
    </section>

    <!-- Today's Progress -->
    <section class="section">
      <h2>üìÖ Today's Progress</h2>
      <div class="progress-bar">
        <div class="progress-fill" style="width: 60%;"></div>
      </div>
      <div class="progress-stats">
        <span>30 / 50 minutes</span>
        <span>60% complete</span>
      </div>
    </section>

    <!-- Quick Actions -->
    <section class="section">
      <h2>‚ö° Quick Actions</h2>
      <div class="actions-grid">
        <a href="log-activity.html" class="action-card">
          <div class="action-icon">‚ûï</div>
          <div class="action-text">
            <h3>Log Activity</h3>
            <p>Record your workout</p>
          </div>
        </a>

        <a href="quests.html" class="action-card" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
          <div class="action-icon">üéØ</div>
          <div class="action-text">
            <h3>Daily Quests</h3>
            <p>Complete challenges</p>
          </div>
        </a>

        <a href="challenges.html" class="action-card" style="background: linear-gradient(135deg, #4CAF50, #45a049);">
          <div class="action-icon">‚öîÔ∏è</div>
          <div class="action-text">
            <h3>Challenges</h3>
            <p>Compete with friends</p>
          </div>
        </a>

        <a href="stats.html" class="action-card" style="background: linear-gradient(135deg, #ff9800, #f57c00);">
          <div class="action-icon">üìä</div>
          <div class="action-text">
            <h3>View Stats</h3>
            <p>Track progress</p>
          </div>
        </a>
      </div>
    </section>

    <!-- Daily Quests -->
    <section class="section">
      <h2>üéØ Daily Quests</h2>
      
      <div class="quest-item">
        <div class="quest-icon">üåÖ</div>
        <div class="quest-info">
          <h4>Morning Jumpstart</h4>
          <p>Complete a 15-minute workout</p>
        </div>
        <div class="quest-points">40 pts</div>
      </div>

      <div class="quest-item">
        <div class="quest-icon">üí™</div>
        <div class="quest-info">
          <h4>Cardio Champion</h4>
          <p>Complete 30 minutes of cardio</p>
        </div>
        <div class="quest-points">60 pts</div>
      </div>

      <div class="quest-item">
        <div class="quest-icon">üßò</div>
        <div class="quest-info">
          <h4>Zen Master</h4>
          <p>Complete a 25-minute yoga session</p>
        </div>
        <div class="quest-points">45 pts</div>
      </div>
    </section>

    <!-- Recent Activities -->
    <section class="section">
      <h2>üèÉ Recent Activities</h2>
      <ul class="activity-list">
        <li class="activity-item">
          <div class="activity-icon">üèÉ</div>
          <div class="activity-info">
            <h4>Running</h4>
            <p>30 minutes ‚Ä¢ 250 calories</p>
          </div>
          <div class="activity-points">+30</div>
        </li>

        <li class="activity-item">
          <div class="activity-icon">üßò</div>
          <div class="activity-info">
            <h4>Yoga</h4>
            <p>25 minutes ‚Ä¢ 120 calories</p>
          </div>
          <div class="activity-points">+25</div>
        </li>

        <li class="activity-item">
          <div class="activity-icon">üèãÔ∏è</div>
          <div class="activity-info">
            <h4>Strength Training</h4>
            <p>45 minutes ‚Ä¢ 300 calories</p>
          </div>
          <div class="activity-points">+45</div>
        </li>
      </ul>
    </section>
  </div>
</body>
</html>
